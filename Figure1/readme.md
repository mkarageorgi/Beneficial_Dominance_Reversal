Code for Figure 1
